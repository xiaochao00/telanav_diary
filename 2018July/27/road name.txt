official name: tags?'name'
alternative name: tags?'alt_name:chi'
route number: tags?'ref:chi'




SELECT province_name, 
SUM(CASE WHEN off_name IS NOT NULL 		  THEN way_dis ELSE 0 END) AS off_dis     ,
SUM(CASE WHEN alt_name IS NOT NULL THEN way_dis ELSE 0 END) AS alt_dis            ,
SUM(CASE WHEN route_number IS NOT NULL	  THEN way_dis ELSE 0 END) AS rou_num_dis 
FROM 
(
	SELECT w.tags->'l2:left' pro_code, r.tags->'name' province_name, 
	w.tags->'name' off_name, w.tags->'alt_name:chi' alt_name, w.tags->'ref:chi' route_number, 
	ST_LENGTH(ST_TRANSFORM(linestring,2346)) way_dis
	FROM ways w, relations r
	WHERE w.tags->'l2:left' = r.id || ''
	ORDER BY w.tags->'l2:left'
) a
GROUP BY province_name



道路等级
FC
pro_code | fc |     off_dis      |     alt_dis      |   rou_num_dis   
---------+----+------------------+------------------+-----------------
450000   | 1  | 42682884.4427807 | 1442685.51847239 | 31353448.0401042
410000   | 5  | 15122695.2319106 | 4963873.38002713 |  13257144.235731
370000   | 3  | 29550403.4008981 | 9358393.46647648 | 22026945.3608077
130000   | 5  | 14966465.6001876 | 6387334.71763449 | 11781115.4447411
430000   | 1  | 53731684.9663191 | 2706238.52440284 | 39002614.7684912
210000   | 1  | 36852606.6322865 | 3635307.81426507 | 4364721.44616793
410000   | 2  | 9275490.58215476 | 1146638.62255796 | 717905.360598607
130000   | 4  | 10997316.4057452 | 4489623.63734313 | 9079692.02670255
350000   | 3  | 11448773.7934908 | 3338814.35406805 |  8772194.7142409
230000   | 1  |  49426323.007087 | 3620532.74660709 | 25022216.2262966
120000   | 3  | 3253580.98663151 | 2725386.48945246 |  2631406.0589077
330000   | 3  | 12792080.4172005 | 8641055.24198284 | 8203233.16575923
130000   | 2  |  5954354.5277973 |  677764.84774048 | 322948.829766501
640000   | 3  | 2965117.29267088 | 900773.908717416 | 2080445.35421683
410000   | 4  | 9046273.37876093 | 3438598.74041749 |  7593223.3899503
530000   | 3  |  13020672.735622 | 4448446.46416184 | 11294443.5620985
450000   | 3  | 10111954.1715866 | 1955784.93740406 | 8321317.82998334
520000   | 2  | 1862242.07766331 | 293378.200624443 | 422466.852681908
310000   | 2  |  5463618.3388765 | 1798273.10668273 | 1522950.25835729
610000   | 2  |  3770594.8451821 | 922124.796804735 | 776657.369623529
500000   | 5  |  7040623.9517775 | 4143756.73215035 | 5400851.68375174
340000   | 2  | 6684602.53415889 | 988321.691311355 | 1186298.14853001
460000   | 5  | 2534039.22347876 | 1622345.47181291 | 1981162.41572585
420000   | 4  | 8977662.57001524 | 3709093.66310827 | 6921538.70521307
340000   | 4  |  6174244.3811773 | 2095012.49230816 |  5114840.2414405
370000   | 1  |  55430760.726092 | 3247847.91942206 | 13954645.8744626
420000   | 2  | 4720433.67717493 | 589632.662824445 | 532592.275498551
310000   | 4  | 1408236.29210189 | 636274.085648267 |  518626.40988837
610000   | 4  | 6570849.83783928 | 2014001.66290406 | 5282816.02554202
210000   | 3  | 13060444.4738438 | 7766914.35142419 | 9158338.52582779
520000   | 4  | 4425932.04098557 |  1518779.5361424 | 3229815.57584344
430000   | 3  | 12644280.4634845 | 2790808.65480674 | 10383254.0426766
310000   | 5  | 1916779.23370897 | 1279982.90463248 | 1676974.52160286
610000   | 5  | 11339974.9952757 | 6995908.87577725 | 9631632.57452522
500000   | 2  | 2069159.81581477 | 425065.845056566 | 359126.762218527
340000   | 5  | 10144131.8758317 | 5973911.29622232 |  9065737.4688067
350000   | 1  | 34017498.5250583 | 3031043.95818235 | 18987192.2193685
460000   | 2  | 594930.968141473 | 77513.2257437779 |  49394.511270087
520000   | 5  | 14694717.8814215 | 6957647.38360434 | 12296975.6251852
230000   | 3  | 10248601.9293717 | 3224190.97915033 | 8462953.01467292
120000   | 1  | 12408122.1660558 | 1449129.84174784 | 1003883.14341128
460000   | 4  |  1366932.8906602 | 260798.969179855 | 1142560.62469707
640000   | 1  | 10522468.1315594 | 436728.746000073 | 3242383.09935855
330000   | 1  | 72364116.7751897 | 17231111.7553356 | 19107950.1582041
420000   | 5  | 13527154.7836315 | 7949212.78673449 | 12900405.9234685
530000   | 1  | 114580239.854831 | 28208590.5702698 | 69706254.7465375
500000   | 4  | 1916809.90453039 | 1053848.85699467 | 1529332.26383657
320000   | 1  | 102022173.734501 |  18764993.407149 | 24979408.3719467
220000   | 3  | 6168214.80484492 | 2632912.12335797 | 4784689.81604293
360000   | 3  |  10731390.334264 | 7318448.43962942 | 8564663.65372321
630000   | 2  | 556507.015294097 | 124809.194286667 | 129111.529370249
110000   | 3  | 4337098.80502766 | 3194957.09572058 | 3201619.04964264
140000   | 1  | 41411128.0523195 | 5089992.93641527 | 27996559.8956053
810000   | 5  | 567313.486806042 | 488229.341681779 | 442737.755680675
820000   | 2  | 163535.606602308 | 4572.76916505655 |                0
510000   | 3  |  17003273.816468 | 6402113.14847414 | 13230692.7109671
630000   | 4  | 3020088.32579768 | 529904.745314308 | 2819271.50133124
540000   | 3  | 5530041.11422643 | 421169.810317275 |  5429914.1424566
810000   | 2  | 866188.908480666 | 83716.8762769104 | 136.415509125295
630000   | 5  | 8455247.38666694 | 2726644.56468524 | 6523000.81925522
620000   | 3  |  7703899.4325191 | 1440101.04881459 | 6736447.90966337
150000   | 3  | 15276625.5227862 | 5411258.47804688 | 13028052.0104272
650000   | 3  | 13896017.6603852 | 3095199.99626227 | 12395108.1036348
810000   | 4  | 37458.0122524969 | 16676.4711704131 | 10594.8849686276
220000   | 1  | 31486767.9561549 | 3025845.97245641 | 20275487.8377331
360000   | 1  | 50622719.0420198 |  10473303.059876 | 40571517.4106666
320000   | 3  | 21901224.1708094 | 11082528.1019508 | 17285149.1556694
440000   | 5  | 20087068.7675519 | 10509772.4376469 | 17266115.0452889
110000   | 1  | 16719822.5461183 | 3302272.48219316 |  3618564.0966399
140000   | 3  | 11490230.2655973 | 5633911.80717246 | 9603572.20573142
510000   | 1  | 78274880.0130168 | 6897589.15716469 | 37606106.1809799
540000   | 1  | 20285361.7949608 | 1082636.66938011 | 16109507.0616721
440000   | 2  | 13669394.4040822 | 2754387.89927806 | 1776468.02191496
440000   | 4  | 11611409.4616803 | 4346575.18011872 | 8789843.43660319
620000   | 1  | 30424661.9435771 |  2107459.1676257 | 23271114.9253215
150000   | 1  | 59766263.1419823 |  9598299.4336252 | 40299568.3554975
650000   | 1  | 68161347.6273483 |  13848213.640531 | 49356782.5766248
150000   | 2  | 5035765.56803381 | 617074.305387955 | 641470.384833475
620000   | 2  | 1115726.72801563 |   148015.5223935 | 24363.9659727359
510000   | 5  | 16311980.6899478 | 10574789.5793943 | 14343915.8752211
540000   | 4  | 2126426.43672801 | 190587.958354118 | 2092950.93506052
650000   | 2  | 3143774.62387751 | 382199.100600066 | 299338.706180187
650000   | 4  |  8004302.2361824 | 1181287.72979978 | 7303780.97815899
810000   | 3  |  271836.90219241 | 20833.6056488412 |                0
110000   | 5  | 2207809.49131995 | 1034379.13399198 | 1299897.77035585
540000   | 2  | 292181.064925697 | 38484.7329701381 | 7434.90078973406
440000   | 1  | 103296351.403765 | 7147930.33522126 | 56445097.4984524
620000   | 4  | 4740900.51670732 | 1204281.19513574 | 4253166.40413747
150000   | 4  | 13085285.4765838 | 2307304.73776154 | 11861382.1879223
220000   | 5  | 8814113.42743968 | 4213298.55422248 | 8293282.36790159
360000   | 5  | 12490633.2844649 |  5517714.8601646 | 11864549.2295126
110000   | 4  | 2016029.74127047 | 1304255.76330571 | 1258028.21916606
650000   | 5  |  19570618.380101 | 8341155.59211264 | 18775153.1016923
150000   | 5  |  13935798.661809 | 6349421.38395451 |  13668611.476079
220000   | 4  | 3882853.12024981 | 1021174.30098695 | 3224906.08311461
360000   | 4  | 6644101.16995519 | 2332679.46204884 |   5700409.176822
620000   | 5  | 10351850.2851761 | 5276277.05363478 | 9256096.22652373
510000   | 2  | 7626447.41761366 | 1619263.34259263 | 752789.226263181
510000   | 4  | 8162727.00584536 | 3296533.01639808 | 6577778.89700114
220000   | 2  | 4350496.25392414 | 554783.391040621 | 2052505.29631127
360000   | 2  | 5888183.04432059 | 1710716.53769287 | 2584885.47988497
630000   | 3  | 4983576.83685567 | 1118731.99785627 | 4720149.10469214
110000   | 2  | 4382881.39215184 | 1165427.76478129 | 908970.157439155
540000   | 5  | 5205465.37651026 | 477922.285734721 | 4229278.65338093
140000   | 5  | 11905663.2656493 | 6838597.30279634 | 11403941.5281183
810000   | 1  | 2163614.98477589 | 40512.5023665574 | 1018.40746123429
440000   | 3  | 22384776.4706196 | 8092952.77489627 | 18076119.3978192
320000   | 5  | 9950237.56435273 | 7442222.37178673 | 9380991.71671254
820000   | 1  | 190126.293045814 | 18623.0121601637 |                0
140000   | 4  | 7335696.81711384 | 2896829.23183084 | 5863613.31240915
320000   | 4  | 8735677.69536395 | 4187037.18095246 | 6239967.54821567
630000   | 1  | 13463306.7316473 | 3627575.97804927 | 8815870.97982026
320000   | 2  | 22104027.3939304 | 5267126.17721142 | 2933253.63297707
140000   | 2  | 4278634.07526923 | 641651.078698695 |   511836.6170465
120000   | 2  | 2883724.86774085 | 440117.539116871 | 123507.448940678
530000   | 2  | 2725849.47998344 | 576976.909942954 | 607309.089447043
330000   | 2  | 13086232.0525464 | 2860022.06526796 |   1317209.829805
370000   | 5  | 13678511.1023597 | 7391573.16410119 | 12346551.4212332
130000   | 3  |   18236477.50515 | 7409278.09489408 | 13694012.9676927
350000   | 4  | 5060859.16488727 |  2181973.0435853 | 3786168.05754286
640000   | 2  |  2541045.2101552 | 324039.452768207 | 111569.708781704
330000   | 4  | 6055815.32011128 | 3085366.30958731 | 4503603.29080985
350000   | 2  | 2815563.40088367 | 526216.050653253 | 442636.400881076
460000   | 1  | 9778974.81139015 | 250836.311103596 | 6877174.35339412
640000   | 4  | 1707747.77337886 | 643888.935441461 | 1354482.69020591
410000   | 3  | 18843696.5847591 | 5766887.28277791 | 15909541.5328756
500000   | 1  | 27814599.0603979 | 4414774.52199258 | 17992542.4718813
530000   | 4  | 7077985.93258978 | 2687509.68279399 |  6323293.9408445
120000   | 4  | 1481118.50130837 | 1030893.75085984 |  968845.66170925
530000   | 5  | 12914243.2133698 | 7381312.51158488 | 11151790.2515299
330000   | 5  | 9758772.07606152 |  6614407.3857267 | 9052976.36889343
370000   | 2  | 14495166.9816765 | 1395976.66906567 | 561334.183077691
420000   | 1  | 52124696.5578507 | 3602950.90772116 |  29184544.158346
640000   | 5  | 3812663.70447579 | 2160244.92135048 | 3497257.68092013
120000   | 5  | 3092380.26363929 | 1496006.75735545 | 2563205.70580358
520000   | 1  | 28874499.1350292 | 1296300.07968729 | 20379837.7600625
370000   | 4  | 11545072.2951271 | 4936944.28839101 | 10249695.7869331
340000   | 1  | 62948806.9857857 | 4833721.84818722 | 42895316.2246561
350000   | 5  | 10506172.5728643 |  6326063.1248087 | 9632900.96285749
310000   | 1  | 17957625.0408249 | 3583479.41324195 | 2659144.78598003
610000   | 1  | 40529612.2250183 | 14890536.9003504 |  16310719.285717
210000   | 5  | 8673950.46940482 |  4788115.6089123 | 8368103.80379252
230000   | 4  | 3938266.60048728 | 2328848.54946548 | 3262753.21137378
430000   | 5  | 14115118.7337796 | 5576336.77155605 | 13056350.2228348
130000   | 1  | 58368255.1064276 | 3588048.00103377 | 29746667.5395307
460000   | 3  | 2639006.02596307 | 480122.603306254 | 1908933.02695594
410000   | 1  | 58824981.5290226 | 4301280.65493769 | 33822195.7954729
500000   | 3  | 9271302.42412715 | 6243061.18383075 | 7359756.36877712
230000   | 2  | 2431838.28575512 | 374597.316347774 | 637245.799033451
450000   | 5  | 12375522.5795267 | 6430744.51328439 | 11251340.8078345
420000   | 3  | 13155908.8752238 | 4468548.76316025 | 10759824.2281803
450000   | 4  |  6570025.7794906 | 2238224.54213163 | 5475221.64626245
210000   | 2  | 7187905.81346648 | 1254573.80061703 | 351983.929097045
430000   | 2  | 5396446.32900699 |   539339.9391631 | 2034590.74092972
210000   | 4  | 6182182.65211254 | 2600703.10518521 | 4690719.94165549
520000   | 3  | 10540557.6997196 | 2098363.85219377 | 8088588.70448803
230000   | 5  | 10435197.7221226 | 6567129.72319512 | 8907477.45744702
430000   | 4  | 6641419.36622885 | 1592397.23915913 | 5357144.64988709
450000   | 2  |  1932000.9542292 | 217461.845139311 | 75801.6420258989
340000   | 3  | 12519328.1614925 | 3674951.43844373 | 10106435.4188579
310000   | 3  | 2846363.95122654 | 2046212.89298191 | 1890016.09009411
610000   | 3  | 8310393.79133258 | 2012142.18357562 | 6090482.14902516

SELECT pro_code, 
	SUM(CASE WHEN fc='1' THEN off_dis END )"off_fc1",
	SUM(CASE WHEN fc='2' THEN off_dis END )"off_fc2",
	SUM(CASE WHEN fc='3' THEN off_dis END )"off_fc3",
	SUM(CASE WHEN fc='4' THEN off_dis END )"off_fc4",
	SUM(CASE WHEN fc='5' THEN off_dis END )"off_fc5",
	
	SUM(CASE WHEN fc='1' THEN alt_dis END )"alt_fc1",
	SUM(CASE WHEN fc='2' THEN alt_dis END )"alt_fc2",
	SUM(CASE WHEN fc='3' THEN alt_dis END )"alt_fc3",
	SUM(CASE WHEN fc='4' THEN alt_dis END )"alt_fc4",
	SUM(CASE WHEN fc='5' THEN alt_dis END )"alt_fc5", 
	
	SUM(CASE WHEN fc='1' THEN rou_num_dis END )"route_fc1",
	SUM(CASE WHEN fc='2' THEN rou_num_dis END )"route_fc2",
	SUM(CASE WHEN fc='3' THEN rou_num_dis END )"route_fc3",
	SUM(CASE WHEN fc='4' THEN rou_num_dis END )"route_fc4",
	SUM(CASE WHEN fc='5' THEN rou_num_dis END )"route_fc5"

FROM  
(
	SELECT pro_code, fc,
	SUM(CASE WHEN off_name IS NOT NULL THEN way_dis ELSE 0 END) AS off_dis ,
	SUM(CASE WHEN alt_name IS NOT NULL THEN way_dis ELSE 0 END) AS alt_dis ,
	SUM(CASE WHEN route_number IS NOT NULL THEN way_dis ELSE 0 END) AS rou_num_dis 
	FROM 
	(
		SELECT w.tags->'l2:left' pro_code,
		w.tags->'name' off_name, w.tags->'alt_name:chi' alt_name, w.tags->'ref:chi' route_number, 
		ST_LENGTH(ST_TRANSFORM(linestring,2346)) way_dis, w.tags->'fc' as fc
		FROM ways w WHERE w.tags?'l2:left' AND w.tags->'type'='nav_link'
		ORDER BY w.tags->'l2:left' 
	) a
	GROUP BY pro_code, fc
) t
GROUP BY pro_code

 pro_code |     off_fc1      |     off_fc2      |     off_fc3      |     off_fc4      |     off_fc5      |     alt_fc1      |     alt_fc2      |     alt_fc3      |     alt_fc4      |     alt_fc5      |    route_fc1     |    route_fc2     |    route_fc3     |    route_fc4     |    route_fc5     
----------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------
 410000   | 58824981.5290229 | 9275490.58215473 | 18843696.5847593 | 9046273.37876106 | 15122695.2319106 | 4301280.65493768 | 1146638.62255797 | 5766887.28277793 |  3438598.7404175 | 4963873.38002714 | 33822195.7954729 | 717905.360598604 | 15909541.5328756 | 7593223.38995025 |  13257144.235731
 130000   | 58368255.1064273 |  5954354.5277973 | 18236477.5051501 | 10997316.4057452 | 14966465.6001876 |  3588048.0010338 |  677764.84774048 | 7409278.09489406 | 4489623.63734314 | 6387334.71763448 | 29746667.5395306 |   322948.8297665 | 13694012.9676925 | 9079692.02670259 | 11781115.4447412
 520000   | 28874499.1350292 | 1862242.07766332 | 10540557.6997195 | 4425932.04098562 | 14694717.8814215 | 1296300.07968729 | 293378.200624443 | 2098363.85219377 | 1518779.53614241 | 6957647.38360433 | 20379837.7600625 | 422466.852681908 | 8088588.70448801 | 3229815.57584343 | 12296975.6251852
 340000   | 62948806.9857866 | 6684602.53415895 | 12519328.1614926 | 6174244.38117731 | 10144131.8758317 | 4833721.84818717 | 988321.691311356 | 3674951.43844372 | 2095012.49230815 | 5973911.29622233 | 42895316.2246561 | 1186298.14853001 | 10106435.4188579 | 5114840.24144053 | 9065737.46880669
 310000   | 17957625.0408248 | 5463618.33887648 | 2846363.95122655 |  1408236.2921019 | 1916779.23370897 | 3583479.41324195 | 1798273.10668274 | 2046212.89298191 | 636274.085648267 | 1279982.90463248 | 2659144.78598001 | 1522950.25835729 |  1890016.0900941 | 518626.409888369 | 1676974.52160286
 610000   | 40529612.2250185 |  3770594.8451821 | 8310393.79133258 | 6570849.83783926 | 11339974.9952757 | 14890536.9003504 | 922124.796804737 | 2012142.18357562 | 2014001.66290406 | 6995908.87577726 |  16310719.285717 | 776657.369623533 | 6090482.14902515 | 5282816.02554201 | 9631632.57452529
 460000   | 9778974.81139013 | 594930.968141474 | 2639006.02596307 |  1366932.8906602 | 2534039.22347876 | 250836.311103596 |  77513.225743778 | 480122.603306255 | 260798.969179855 | 1622345.47181291 |  6877174.3533941 | 49394.5112700869 | 1908933.02695593 | 1142560.62469707 | 1981162.41572585
 630000   | 13463306.7316473 | 556507.015294097 | 4983576.83685566 | 3020088.32579768 | 8455247.38666693 | 3627575.97804926 | 124809.194286667 | 1118731.99785627 | 529904.745314308 | 2726644.56468525 | 8815870.97982026 | 129111.529370249 | 4720149.10469212 | 2819271.50133125 | 6523000.81925521
 440000   | 103296351.403763 | 13669394.4040822 | 22384776.4706194 | 11611409.4616802 |  20087068.767552 | 7147930.33522124 | 2754387.89927807 | 8092952.77489627 |  4346575.1801187 | 10509772.4376468 | 56445097.4984515 | 1776468.02191496 | 18076119.3978193 | 8789843.43660324 | 17266115.0452888
 620000   | 30424661.9435771 | 1115726.72801563 | 7703899.43251908 | 4740900.51670732 | 10351850.2851761 | 2107459.16762571 | 148015.522393499 | 1440101.04881458 | 1204281.19513574 | 5276277.05363478 | 23271114.9253216 | 24363.9659727359 | 6736447.90966335 | 4253166.40413748 | 9256096.22652375
 150000   | 59766263.1419828 | 5035765.56803382 | 15276625.5227863 | 13085285.4765837 |  13935798.661809 | 9598299.43362521 | 617074.305387957 | 5411258.47804691 | 2307304.73776155 | 6349421.38395453 | 40299568.3554978 | 641470.384833475 | 13028052.0104272 | 11861382.1879223 |  13668611.476079
 220000   | 31486767.9561552 | 4350496.25392414 | 6168214.80484489 |  3882853.1202498 |  8814113.4274397 |  3025845.9724564 | 554783.391040621 | 2632912.12335798 | 1021174.30098696 | 4213298.55422249 | 20275487.8377328 | 2052505.29631127 | 4784689.81604293 | 3224906.08311461 |  8293282.3679016
 320000   | 102022173.734501 | 22104027.3939307 | 21901224.1708089 | 8735677.69536392 | 9950237.56435275 |  18764993.407149 | 5267126.17721144 | 11082528.1019509 | 4187037.18095243 | 7442222.37178673 | 24979408.3719467 | 2933253.63297704 |  17285149.155669 | 6239967.54821572 | 9380991.71671255
 640000   | 10522468.1315593 |  2541045.2101552 | 2965117.29267088 | 1707747.77337886 | 3812663.70447578 | 436728.746000073 | 324039.452768208 | 900773.908717413 | 643888.935441461 | 2160244.92135047 | 3242383.09935853 | 111569.708781704 | 2080445.35421682 | 1354482.69020591 | 3497257.68092013
 370000   | 55430760.7260922 | 14495166.9816765 |  29550403.400898 | 11545072.2951269 | 13678511.1023597 | 3247847.91942205 | 1395976.66906566 | 9358393.46647659 | 4936944.28839108 | 7391573.16410117 | 13954645.8744627 | 561334.183077691 | 22026945.3608075 |  10249695.786933 | 12346551.4212332
 230000   | 49426323.0070881 | 2431838.28575512 | 10248601.9293718 | 3938266.60048727 | 10435197.7221227 | 3620532.74660708 | 374597.316347773 | 3224190.97915031 | 2328848.54946547 | 6567129.72319511 | 25022216.2262963 | 637245.799033451 | 8462953.01467294 | 3262753.21137378 | 8907477.45744704
 430000   |  53731684.966319 | 5396446.32900703 | 12644280.4634844 | 6641419.36622881 | 14115118.7337796 | 2706238.52440284 | 539339.939163099 | 2790808.65480675 | 1592397.23915913 | 5576336.77155604 |  39002614.768491 | 2034590.74092971 | 10383254.0426765 | 5357144.64988706 | 13056350.2228348
 420000   | 52124696.5578508 | 4720433.67717494 | 13155908.8752236 | 8977662.57001527 | 13527154.7836315 | 3602950.90772117 | 589632.662824444 | 4468548.76316029 | 3709093.66310828 | 7949212.78673451 | 29184544.1583462 | 532592.275498551 | 10759824.2281803 | 6921538.70521312 | 12900405.9234685
 500000   | 27814599.0603978 | 2069159.81581476 | 9271302.42412721 | 1916809.90453039 | 7040623.95177749 | 4414774.52199258 | 425065.845056565 | 6243061.18383072 | 1053848.85699466 | 4143756.73215035 | 17992542.4718814 | 359126.762218527 | 7359756.36877711 | 1529332.26383658 | 5400851.68375175
 820000   | 190126.293045814 | 163535.606602308 |                  |                  |                  | 18623.0121601637 | 4572.76916505655 |                  |                  |                  |                0 |                0 |                  |                  |                 
 810000   | 2163614.98477588 | 866188.908480666 |  271836.90219241 | 37458.0122524969 | 567313.486806042 | 40512.5023665574 | 83716.8762769104 | 20833.6056488412 | 16676.4711704131 | 488229.341681779 | 1018.40746123429 | 136.415509125295 |                0 | 10594.8849686276 | 442737.755680674
 650000   |  68161347.627348 | 3143774.62387748 | 13896017.6603853 | 8004302.23618238 |  19570618.380101 | 13848213.6405308 | 382199.100600067 | 3095199.99626226 | 1181287.72979978 | 8341155.59211263 | 49356782.5766252 | 299338.706180187 | 12395108.1036348 | 7303780.97815898 | 18775153.1016923
 540000   | 20285361.7949607 | 292181.064925697 | 5530041.11422642 | 2126426.43672802 | 5205465.37651026 | 1082636.66938011 | 38484.7329701381 | 421169.810317274 | 190587.958354118 | 477922.285734721 | 16109507.0616721 | 7434.90078973406 | 5429914.14245658 | 2092950.93506052 | 4229278.65338092
 510000   | 78274880.0130176 | 7626447.41761368 | 17003273.8164681 | 8162727.00584537 | 16311980.6899479 | 6897589.15716469 | 1619263.34259262 | 6402113.14847414 | 3296533.01639807 | 10574789.5793944 | 37606106.1809801 | 752789.226263182 | 13230692.7109672 | 6577778.89700115 | 14343915.8752212
 360000   | 50622719.0420199 | 5888183.04432058 |  10731390.334264 | 6644101.16995516 | 12490633.2844649 |  10473303.059876 | 1710716.53769287 | 7318448.43962949 | 2332679.46204883 |  5517714.8601646 | 40571517.4106673 | 2584885.47988496 |  8564663.6537233 |   5700409.176822 | 11864549.2295126
 110000   | 16719822.5461183 | 4382881.39215186 | 4337098.80502765 | 2016029.74127046 | 2207809.49131996 | 3302272.48219315 | 1165427.76478129 | 3194957.09572059 | 1304255.76330571 | 1034379.13399198 | 3618564.09663994 | 908970.157439153 | 3201619.04964264 | 1258028.21916606 | 1299897.77035585
 140000   | 41411128.0523197 | 4278634.07526919 | 11490230.2655973 | 7335696.81711384 | 11905663.2656493 | 5089992.93641529 | 641651.078698694 | 5633911.80717249 | 2896829.23183085 | 6838597.30279632 | 27996559.8956053 | 511836.617046501 | 9603572.20573142 | 5863613.31240911 | 11403941.5281183
 120000   | 12408122.1660558 | 2883724.86774086 | 3253580.98663152 | 1481118.50130837 | 3092380.26363929 | 1449129.84174785 | 440117.539116872 | 2725386.48945246 | 1030893.75085984 | 1496006.75735545 | 1003883.14341128 | 123507.448940678 |  2631406.0589077 |  968845.66170925 | 2563205.70580359
 330000   | 72364116.7751893 | 13086232.0525462 | 12792080.4172005 | 6055815.32011133 | 9758772.07606155 | 17231111.7553359 | 2860022.06526794 | 8641055.24198277 | 3085366.30958732 | 6614407.38572668 | 19107950.1582044 | 1317209.82980501 | 8203233.16575919 | 4503603.29080983 | 9052976.36889341
 530000   | 114580239.854832 | 2725849.47998345 | 13020672.7356218 | 7077985.93258978 | 12914243.2133698 | 28208590.5702697 | 576976.909942954 | 4448446.46416181 | 2687509.68279398 | 7381312.51158488 | 69706254.7465376 | 607309.089447043 | 11294443.5620985 | 6323293.94084448 | 11151790.2515299
 350000   | 34017498.5250581 | 2815563.40088366 | 11448773.7934908 | 5060859.16488728 | 10506172.5728643 | 3031043.95818235 | 526216.050653252 | 3338814.35406805 | 2181973.04358531 | 6326063.12480871 | 18987192.2193684 | 442636.400881075 | 8772194.71424087 | 3786168.05754282 | 9632900.96285747
 210000   | 36852606.6322866 | 7187905.81346642 | 13060444.4738438 | 6182182.65211256 | 8673950.46940484 | 3635307.81426507 | 1254573.80061702 | 7766914.35142422 |  2600703.1051852 |  4788115.6089123 | 4364721.44616795 | 351983.929097045 | 9158338.52582782 | 4690719.94165553 | 8368103.80379251
 450000   | 42682884.4427806 | 1932000.95422921 | 10111954.1715866 | 6570025.77949058 | 12375522.5795267 | 1442685.51847238 | 217461.845139311 | 1955784.93740405 | 2238224.54213165 | 6430744.51328439 | 31353448.0401043 |  75801.642025899 | 8321317.82998338 | 5475221.64626241 | 11251340.8078345
(33 rows)

	SELECT prn_code, r.tags->'name' prn_name, fc, off_dis, alt_dis, rou_dis
	FROM(
	SELECT prn_code, fc,
	SUM(CASE WHEN off_name IS NOT NULL THEN way_dis ELSE 0 END) AS off_dis ,
	SUM(CASE WHEN alt_name IS NOT NULL THEN way_dis ELSE 0 END) AS alt_dis ,
	SUM(CASE WHEN route_number IS NOT NULL THEN way_dis ELSE 0 END) AS rou_dis 
	FROM 
	(
		SELECT w.tags->'l2:left' prn_code,
		w.tags->'name' off_name, w.tags->'alt_name:chi' alt_name, w.tags->'ref:chi' route_number, 
		ST_LENGTH(ST_TRANSFORM(linestring, 2346)) way_dis, w.tags->'functional_class' as fc
		FROM ways w WHERE w.tags?'l2:left' AND w.tags->'type'='nav_link'
		ORDER BY w.tags->'l2:left' 
	) a
	GROUP BY prn_code, fc
	ORDER BY prn_code, fc
	) b, relations r
	WHERE r.id=b.prn_code::bigint
	
	
	
WITH road_name_temp AS
(
	SELECT w.tags->'l2:left' prn_code,
	w.tags->'name' off_name, w.tags->'alt_name:chi' alt_name, w.tags->'ref:chi' route_number, 
	ST_LENGTH(ST_TRANSFORM(linestring, 2346)) way_dis, w.tags->'functional_class' as fc
	FROM ways w WHERE w.tags?'l2:left' AND w.tags->'type'='nav_link'
	ORDER BY w.tags->'l2:left' 
)	


SELECT prn_code, r.tags->'name' prn_name, fc, off_dis, alt_dis, rou_dis
FROM
(
	SELECT prn_code, fc,
	SUM(CASE WHEN off_name IS NOT NULL THEN way_dis ELSE 0 END) AS off_dis ,
	SUM(CASE WHEN alt_name IS NOT NULL THEN way_dis ELSE 0 END) AS alt_dis ,
	SUM(CASE WHEN route_number IS NOT NULL THEN way_dis ELSE 0 END) AS rou_dis 
	FROM road_name_temp
	GROUP BY prn_code, fc
	ORDER BY prn_code, fc
) b, relations r
WHERE r.id=b.prn_code::bigint
	



	

